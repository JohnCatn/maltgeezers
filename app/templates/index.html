{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

{% block content %}
  <header>
    <h1 class="text-center">Latest Tasting Notes</h2>
  </header>
  <div class="centered">
  <section class="cards cards_align">
      {% for review in tasting.reviews %}
        {% with%}
          {% include '_review.html'  %}
        {% endwith %}
      {% endfor %}
  </div>
</div>
  <header>
    <h1 class="text-center">Our Top Reviews</h1>
  </header>
  <div class="centered">
  <section class="cards">
      {% for review in reviews %}
        {% with%}
          {% include '_review.html'  %}
        {% endwith %}
      {% endfor %}
  </div>
</div>

<!-- Modal -->
<div id="modalReview" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalPictureLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <!-- Modal - header -->
      <div class="modal-header">
        <h4 class="modal-title"></h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span class="fa fa-times" aria-hidden="true"></span>

          <span class="sr-only">Close</span>
        </button>
      </div><!-- .end Modal - header -->

      <!-- Modal - body -->
      <div class="modal-body">
        <div class="container">
          <div class="row">
            <div class="col-md-3">
              <img class="js-modal-image" src="" alt="" />
            </div>
            <div class="col-md-9">
              <div class="container">
                <div class="row">
                  <div class="col-md-6">
                    <b>Distillery:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="distillery"></span>
                  </div>
                  <div class="col-md-6 age">
                    <b>Age:</b>
                  </div>
                  <div class="col-md-6 age">
                    <span id="age"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Notes:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="notes"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Tasting:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="tasting_notes"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Max:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="max_rating"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Average:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="avg_rating"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Min:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="min_rating"></span>
                  </div>
                  <div class="col-md-6">
                    <b>Tasting Date:</b>
                  </div>
                  <div class="col-md-6">
                    <span id="tasting_date"></span>
                  </div>
          </div>
            </div>

      </div>
      </div><!-- .end Modal - body -->

      <!-- Modal - footer -->
      <div class="modal-footer">

        <a class="js-heart m-r" href="#" aria-label="Like">
          <span class="fa fa-heart" aria-hidden="true"></span>

          <span class="sr-only">Like</span>
        </a>

        <a class="m-r" href="#" target="_blank" aria-label="Comment">
          <span class="fa fa-comment" aria-hidden="true"></span>

          <span class="sr-only">Comment</span>
        </a>

        <a href="https://twitter.com/home?status=Check%20out%20this%20Whisky%20Review%20by%20the%20MaltGeezers%20http%3A//www.matgeezers.org" target="_blank" aria-label="Share">
          <span class="fa fa-twitter" aria-hidden="true"></span>

          <span class="sr-only">Tweet it</span>
        </a>
      </div><!-- .end Modal - footer -->
    </div>
  </div>
</div>
<!-- .end modal -->

      <div class="card-columns">

    </div>

<nav aria-label="...">
        <ul class="pager">
            <li class="previous{% if not prev_url %} disabled{% endif %}">
                <a href="{{ prev_url or '#' }}">
                    <span aria-hidden="true">&larr;</span> Newer posts
                </a>
            </li>
            <li class="next{% if not next_url %} disabled{% endif %}">
                <a href="{{ next_url or '#' }}">
                    Older posts <span aria-hidden="true">&rarr;</span>
                </a>
            </li>
        </ul>
    </nav>
  <!-- /.container -->
{% endblock %}

{% block scripts %}
{{ super() }}

<script>
    $('#modalReview').on('show.bs.modal', function (event) {
          var button = $(event.relatedTarget) // Button that triggered the modal
          var review_id = button.data('id') // Extract info from data-* attributes
          var modal = $(this);
            $.ajax({
                type: "GET",
                url: "{{url_for('api.get_reviews')}}/" + review_id,
                data: '',
                cache: false,
                success: function (data) {
                    console.log(data);

                    $('.modal-title').html(data.name);
                    $('#distillery').html(data.distillery);
                    $('#notes').html(data.notes);
                    $('#tasting_notes').html(data.tasting_notes);
                    $('#max_rating').html(data.max_rating);
                    $('#avg_rating').html(data.avg_rating);
                    $('#min_rating').html(data.min_rating);
                    $('#tasting_date').html(data.tasting.date);
                    if(data.age==0){
                      $('.age').hide();
                    } else {
                      $('#age').html(data.age);
                    }
                    $('.js-modal-image').attr('src', data.img_url);

                },
                error: function(err) {
                    console.log(err);
                }
            });
    })
 </script>

{% endblock %}
